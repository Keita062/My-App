<!-- work_report_app/templates/report/form.html -->
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% if report %}日報編集{% else %}新規日報作成{% endif %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container form-container">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
            <h1 style="font-size: 1.875rem; margin-bottom: 0;">{% if report %}日報編集{% else %}新規日報作成{% endif %}</h1>
            <a href="{{ url_for('report.list_reports') }}" class="link">&larr; 一覧に戻る</a>
        </div>

        <form action="{{ url_for('report.edit_report', id=report.id) if report else url_for('report.new_report') }}" method="post" class="card">
            
            <!-- 開始報告セクション -->
            <fieldset {% if report and report.status == 1 %}disabled{% endif %}>
                <h2>開始報告</h2>
                <div class="form-group">
                    <label for="report_date">日付</label>
                    <input type="date" id="report_date" name="report_date" value="{{ report.report_date.strftime('%Y-%m-%d') if report else today }}" required>
                </div>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="scheduled_start_time">予定業務時間（開始）</label>
                        <input type="time" id="scheduled_start_time" name="scheduled_start_time" value="{{ report.scheduled_start_time or '' }}" required>
                    </div>
                    <div class="form-group">
                        <label for="scheduled_end_time">予定業務時間（終了）</label>
                        <input type="time" id="scheduled_end_time" name="scheduled_end_time" value="{{ report.scheduled_end_time or '' }}" required>
                    </div>
                </div>
                <div class="form-group">
                    <label for="scheduled_tasks">予定業務内容</label>
                    <textarea id="scheduled_tasks" name="scheduled_tasks" rows="4" required>{{ report.scheduled_tasks or '' }}</textarea>
                </div>
                <div class="form-group">
                    <label for="goals">業務目標</label>
                    <textarea id="goals" name="goals" rows="3" required>{{ report.goals or '' }}</textarea>
                </div>
            </fieldset>

            {% if not report %}
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">開始報告を登録</button>
            </div>
            {% endif %}

            <!-- 完了報告セクション (編集時のみ表示) -->
            {% if report %}
            <hr>
            <h2>完了報告</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label for="actual_start_time">実施業務時間（開始）</label>
                    <input type="time" id="actual_start_time" name="actual_start_time" value="{{ report.actual_start_time or '' }}" required>
                </div>
                <div class="form-group">
                    <label for="actual_end_time">実施業務時間（終了）</label>
                    <input type="time" id="actual_end_time" name="actual_end_time" value="{{ report.actual_end_time or '' }}" required>
                </div>
            </div>
            <div class="form-group">
                <label for="completed_tasks">実施業務内容</label>
                <textarea id="completed_tasks" name="completed_tasks" rows="4" required>{{ report.completed_tasks or '' }}</textarea>
            </div>
            <div class="form-group">
                <label for="reflection">反省・考察</label>
                <textarea id="reflection" name="reflection" rows="4" required>{{ report.reflection or '' }}</textarea>
            </div>
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">完了報告を登録</button>
            </div>
            {% endif %}
        </form>
    </div>
</body>
</html>
